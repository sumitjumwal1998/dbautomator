---
#playbook for grand privileges in a particular Database
- hosts: server
  become: true # Add this to ensure you have permissions to install packages
  gather_facts: true
  
  
  vars:
    table_name: "{{ table_name }}"
    db_name: "{{ DATABASENAME }}"
    login_user: "{{ user }}"
    login_password: "{{ login_password_var }}"
  
  
  tasks:
    - name: Ensure psycopg2 library is installed for Python
      ansible.builtin.apt:
        name: python3-psycopg2 # Use the apt package name for psycopg2
        state: present
    - name: Run VACUUM on the specified table
      postgresql_query:
        db: "{{ db_name }}"
        login_user: "{{ login_user }}"
        login_password: "{{ login_password }}"
        query: "VACUUM {{ table_name }};"
        autocommit: True
